(function(e){"use strict";const t=cumcord.modules.webpackModules,o=e.React.useState;t.findByDisplayName("Switch"),t.findByDisplayName("Text"),t.findByDisplayName("Header");const s=t.findByDisplayName("SwitchItem");var a=t=>{const[a,n]=o(t.enabled);return e.React.createElement(s,{value:t.value,note:t.note,onChange:()=>{n(!a),t.onChange()},value:a},t.name)};const n=cumcord.modules.webpackModules,l=n.findByDisplayName("FormTitle"),d=n.findByDisplayName("FormDivider"),c=n.findByDisplayName("FormSection");var i=()=>e.React.createElement(c,null,e.React.createElement(l,{tag:"h1"},"BetterMessageDeletion"),e.React.createElement(d,null),e.React.createElement(a,{name:"Enable Toasts",note:"Show a toast when a message is deleted.",onChange:()=>{void 0!==window.betterMessageDeletion_enableToasts?window.betterMessageDeletion_enableToasts=!window.betterMessageDeletion_enableToasts:window.betterMessageDeletion_enableToasts=!0},enabled:!1}));const r=cumcord.modules.webpackModules.findByProps("getElementFromMessageId").getElementFromMessageId,m=Object.getPrototypeOf(cumcord.modules.webpackModules.findByProps("dispatch")),u=Object.getPrototypeOf(cumcord.modules.webpackModules.findByProps("getChannel")).getChannel,g=Object.getPrototypeOf(cumcord.modules.webpackModules.findByProps("getGuild")).getGuild,p=cumcord.modules.webpackModules.findByDisplayName("SettingsView");let b,y,w,f=[];function D(){for(let e of f)try{document.getElementById(e.id).classList.contains("deleted-message")||document.getElementById(e.id).classList.add("deleted-message")}catch(e){}}return{onLoad(){window.betterMessageDeletion_enableToasts=!1,w=cumcord.patcher.injectCSS(".deleted-message{background-color: rgba(240, 71, 71, 0.1);}"),y=setInterval(D,300),b=cumcord.patcher.instead("dispatch",m,((e,t)=>{if("MESSAGE_DELETE"===e[0].type){console.log(e);try{var o={deletedHtmlElement:r(e[0].id)};if(o.deletedText=o.deletedHtmlElement.innerText.split("\n")[3],o.id="chat-messages-"+e[0].id,o.deletedHtmlElement,console.log("[messagedeletion] New Deleted Message: "+o.deletedText),-1==f.indexOf(o)&&f.push(o),window.betterMessageDeletion_enableToasts){var s=g(u(e[0].channelId).guild_id).name;cumcord.ui.toasts.showToast({title:`New deleted message in ${s}!`,duration:3e3})}return console.log(f),void 0}catch(e){console.log("[messagedeletion] Failed to get deleted message!"),console.error(e)}}return t(...e)})),cumcord.patcher.after("getPredicateSections",p.prototype,((e,t)=>{const o=[{section:"DIVIDER"},{section:"HEADER",label:"BetterMessageDeletion"},{section:"BMD",label:"Settings",element:i}];return t.push(...o),t}))},onUnload(){w(),b(),clearInterval(y)}}})(cumcord.modules.common);